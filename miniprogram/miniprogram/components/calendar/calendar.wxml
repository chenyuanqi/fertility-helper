<!--components/calendar/calendar.wxml-->
<view class="calendar-container">
  <!-- æ—¥å†å¤´éƒ¨ -->
  <view class="calendar-header">
    <button class="nav-btn" bindtap="onPrevMonth">â€¹</button>
    <view class="month-title">{{currentYear}}å¹´{{currentMonth}}æœˆ</view>
    <button class="nav-btn" bindtap="onNextMonth">â€º</button>
    <button class="today-btn" bindtap="onToday">ä»Š</button>
  </view>

  <!-- æ˜ŸæœŸæ ‡é¢˜ -->
  <view class="week-header">
    <view wx:for="{{weekDays}}" wx:key="*this" class="week-day">{{item}}</view>
  </view>

  <!-- æ—¥å†ç½‘æ ¼ -->
  <view class="calendar-grid">
    <view wx:for="{{calendarGrid}}" wx:key="index" class="calendar-week">
      <view wx:for="{{item}}" wx:key="day" 
            wx:for-item="dayItem" 
            class="calendar-day {{dayItem.isCurrentMonth ? 'current-month' : 'other-month'}} {{dayItem.isToday ? 'today' : ''}} {{selectedDate === dayItem.date ? 'selected' : ''}}"
            bindtap="onDateClick"
            data-date="{{dayItem.date}}"
            data-is-current-month="{{dayItem.isCurrentMonth}}">
        
        <!-- æ—¥æœŸæ•°å­— -->
        <view class="day-number">{{dayItem.day}}</view>
        
        <!-- æ•°æ®æ‘˜è¦ï¼ˆä»…å½“å‰æœˆæ˜¾ç¤ºï¼‰ -->
        <view wx:if="{{dayItem.isCurrentMonth && dayItem.data}}" class="day-summary">
          <!-- ä½“æ¸©æŒ‡ç¤ºå™¨ -->
          <view wx:if="{{dayItem.data.hasTemperature}}" 
                class="temp-indicator {{dayItem.data.temperatureValue >= 36.8 ? 'high-temp' : 'normal-temp'}}">
          </view>
          
          <!-- ç»æœŸèƒŒæ™¯ -->
          <view wx:if="{{dayItem.data.hasMenstrual}}" 
                class="menstrual-bg menstrual-{{dayItem.data.menstrualFlow}}">
          </view>
          
          <!-- åŒæˆ¿æ ‡è®° -->
          <view wx:if="{{dayItem.data.hasIntercourse}}" class="intercourse-mark">
            <text class="intercourse-icon" style="color: #6a0dad;">ğŸ’•</text>
            <text wx:if="{{dayItem.data.intercourseCount > 1}}" class="intercourse-count">{{dayItem.data.intercourseCount}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å›¾ä¾‹è¯´æ˜ -->
  <view class="calendar-legend">
    <view class="legend-item">
      <view class="legend-symbol temp-indicator high-temp"></view>
      <text class="legend-text">é«˜æ¸©</text>
    </view>
    <view class="legend-item">
      <view class="legend-symbol temp-indicator normal-temp"></view>
      <text class="legend-text">ä½“æ¸©</text>
    </view>
    <view class="legend-item">
      <view class="legend-symbol menstrual-bg menstrual-heavy"></view>
      <text class="legend-text">ç»æœŸ</text>
    </view>
    <view class="legend-item">
      <text class="legend-symbol intercourse-icon" style="color: #6a0dad;">ğŸ’•</text>
      <text class="legend-text">åŒæˆ¿</text>
    </view>
  </view>
</view>