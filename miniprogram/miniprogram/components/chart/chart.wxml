<!--components/chart/chart.wxml-->
<!--components/chart/chart.wxml-->
<view class="chart-container" style="width: {{width}}rpx; height: {{height}}rpx;">
  <!-- æ•°æ®ä¸ºç©ºçš„çŠ¶æ€ -->
  <view wx:if="{{!processedData || processedData.length === 0}}" class="chart-empty">
    <text class="empty-text">æš‚æ— æ•°æ®</text>
  </view>
  
  <!-- ä¸‰åˆä¸€å›¾è¡¨æ˜¾ç¤º -->
  <view wx:else class="chart-content">
    <!-- Yè½´æ ‡ç­¾ -->
    <view class="y-axis">
      <view class="y-label">37.5</view>
      <view class="y-label">37.0</view>
      <view class="y-label">36.5</view>
      <view class="y-label">36.0</view>
      <view class="y-label">35.5</view>
    </view>
    
    <!-- Xè½´æ ‡ç­¾ -->
    <!-- Xè½´æ ‡ç­¾ -->
    <!-- Xè½´æ ‡ç­¾ -->
    <view class="x-axis">
      <view wx:for="{{displayIndexes}}" wx:key="*this" 
            class="x-label"
            style="left: {{(item / (processedData.length - 1)) * 100}}%;">
        {{processedData[item].dateDisplay}}
      </view>
    </view>
    
    <!-- å›¾è¡¨å†…å®¹åŒºåŸŸ -->
    <view class="chart-content-area">
      <!-- ç»é‡èƒŒæ™¯ -->
      <view wx:if="{{viewMode === 'all'}}" class="menstrual-backgrounds">
        <view wx:for="{{processedData}}" wx:key="index" 
              class="menstrual-bg menstrual-level-{{item.menstrualLevel || 0}}"
              wx:if="{{item.hasMenstrual}}"
              style="left: {{(index / (processedData.length - 1)) * 100}}%; width: {{100 / processedData.length}}%;">
        </view>
      </view>
      
      <!-- Cover-line è¦†ç›–çº¿ -->
      <view wx:if="{{coverLine && (viewMode === 'all' || viewMode === 'temperature')}}" 
            class="cover-line"
            style="bottom: {{coverLine.percent}}%;">
      </view>
      
      <!-- ä½“æ¸©çº¿å’Œç‚¹ -->
      <view class="temperature-layer">
        <!-- ä½“æ¸©ç‚¹ -->
        <view wx:for="{{processedData}}" wx:key="index" 
              wx:if="{{item.hasTemperature}}"
              class="temperature-point {{item.isHighTemp ? 'high-temp' : ''}} {{item.isAboveCoverLine ? 'above-coverline' : ''}}"
              style="left: {{(index / (processedData.length - 1)) * 100}}%; bottom: {{item.temperaturePercent}}%;"
              bindtap="onPointClick"
              data-index="{{index}}">
        </view>
      </view>
      
      <!-- åŒæˆ¿æ ‡è®° -->
      <view wx:if="{{viewMode === 'all'}}" class="intercourse-markers">
        <view wx:for="{{processedData}}" wx:key="index" 
              wx:if="{{item.hasIntercourse}}"
              class="intercourse-marker"
              style="left: {{(index / (processedData.length - 1)) * 100}}%;">
          <text class="marker-icon">ğŸ’•</text>
          <text wx:if="{{item.intercourseCount > 1}}" class="marker-count">{{item.intercourseCount}}</text>
        </view>
      </view>
      
      <!-- æ’åµæ—¥æ ‡è®° -->
      <view wx:if="{{ovulationPrediction && (viewMode === 'all' || viewMode === 'temperature')}}" class="ovulation-markers">
        <view wx:for="{{processedData}}" wx:key="index" 
              wx:if="{{item.isOvulationDay}}"
              class="ovulation-marker confidence-{{ovulationPrediction.confidence}}"
              style="left: {{(index / (processedData.length - 1)) * 100}}%;">
          <text class="ovulation-icon">O</text>
        </view>
      </view>
    </view>
  </view>
</view>
