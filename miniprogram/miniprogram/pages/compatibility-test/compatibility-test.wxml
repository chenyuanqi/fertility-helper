<!-- å…¼å®¹æ€§æµ‹è¯•é¡µé¢ -->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="header">
    <view class="title">å…¼å®¹æ€§æµ‹è¯•</view>
    <view class="subtitle">æ£€æµ‹å°ç¨‹åºåœ¨å½“å‰ç¯å¢ƒä¸‹çš„å…¼å®¹æ€§</view>
  </view>

  <!-- å…¼å®¹æ€§ä¿¡æ¯å¡ç‰‡ -->
  <view class="compatibility-info" wx:if="{{compatibilityReport}}">
    <view class="info-title">è®¾å¤‡ä¿¡æ¯</view>
    
    <view class="info-item">
      <view class="info-label">è®¾å¤‡å‹å·</view>
      <view class="info-value">{{compatibilityReport.systemInfo.model || 'Unknown'}}</view>
    </view>
    
    <view class="info-item">
      <view class="info-label">æ“ä½œç³»ç»Ÿ</view>
      <view class="info-value">{{compatibilityReport.systemInfo.system || 'Unknown'}}</view>
    </view>
    
    <view class="info-item">
      <view class="info-label">å¾®ä¿¡ç‰ˆæœ¬</view>
      <view class="info-value">{{compatibilityReport.systemInfo.version || 'Unknown'}}</view>
    </view>
    
    <view class="info-item">
      <view class="info-label">åŸºç¡€åº“ç‰ˆæœ¬</view>
      <view class="info-value">{{compatibilityReport.systemInfo.SDKVersion || 'Unknown'}}</view>
    </view>
    
    <view class="info-item">
      <view class="info-label">å±å¹•å°ºå¯¸</view>
      <view class="info-value">{{compatibilityReport.systemInfo.windowWidth}}Ã—{{compatibilityReport.systemInfo.windowHeight}}</view>
    </view>

    <!-- å…¼å®¹æ€§è¯„åˆ† -->
    <view class="compatibility-score" wx:if="{{compatibilityReport.overallCompatibility}}">
      <view class="score-text">{{compatibilityReport.overallCompatibility.score}}/100</view>
      <view class="score-level">å…¼å®¹æ€§ç­‰çº§: {{compatibilityReport.overallCompatibility.level}}</view>
    </view>
  </view>

  <!-- æµ‹è¯•æ§åˆ¶åŒºåŸŸ -->
  <view class="test-control">
    <!-- æµ‹è¯•çŠ¶æ€æ˜¾ç¤º -->
    <view class="test-status status-{{testStatus}}">
      <!-- çŠ¶æ€å›¾æ ‡ -->
      <view class="status-icon status-icon-{{testStatus}}">
        <text wx:if="{{testStatus === 'ready'}}">ğŸš€</text>
        <text wx:if="{{testStatus === 'running'}}">â³</text>
        <text wx:if="{{testStatus === 'completed'}}">âœ…</text>
        <text wx:if="{{testStatus === 'failed'}}">âŒ</text>
      </view>
      
      <!-- çŠ¶æ€æ–‡å­— -->
      <view class="status-text">
        <text wx:if="{{testStatus === 'ready'}}">å‡†å¤‡å¼€å§‹æµ‹è¯•</text>
        <text wx:if="{{testStatus === 'running'}}">æ­£åœ¨æ‰§è¡Œæµ‹è¯•...</text>
        <text wx:if="{{testStatus === 'completed'}}">æµ‹è¯•å®Œæˆ</text>
        <text wx:if="{{testStatus === 'failed'}}">æµ‹è¯•å¤±è´¥</text>
      </view>
      
      <!-- å½“å‰æµ‹è¯•é¡¹ç›® -->
      <view class="current-test" wx:if="{{currentTest}}">{{currentTest}}</view>
    </view>

    <!-- è¿›åº¦æ¡ -->
    <view class="progress-container" wx:if="{{testStatus === 'running'}}">
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{progress}}%"></view>
      </view>
      <view class="progress-text">{{progress}}%</view>
    </view>

    <!-- å¼€å§‹æµ‹è¯•æŒ‰é’® -->
    <button 
      class="btn btn-primary {{testStatus === 'running' ? 'btn-disabled' : ''}}" 
      wx:if="{{testStatus === 'ready' || testStatus === 'failed'}}"
      bindtap="startCompatibilityTest"
      disabled="{{testStatus === 'running'}}">
      {{testStatus === 'failed' ? 'é‡æ–°æµ‹è¯•' : 'å¼€å§‹æµ‹è¯•'}}
    </button>

    <!-- é‡æ–°æµ‹è¯•æŒ‰é’® -->
    <button 
      class="btn btn-secondary" 
      wx:if="{{testStatus === 'completed'}}"
      bindtap="retryTest">
      é‡æ–°æµ‹è¯•
    </button>
  </view>

  <!-- æµ‹è¯•ç»“æœåŒºåŸŸ -->
  <view class="test-results" wx:if="{{testResults}}">
    <view class="results-title">æµ‹è¯•ç»“æœ</view>
    
    <!-- ç»“æœæ¦‚è§ˆ -->
    <view class="results-summary">
      <view class="summary-item">
        <view class="summary-number">{{testResults.summary.totalTests}}</view>
        <view class="summary-label">æ€»æµ‹è¯•</view>
      </view>
      <view class="summary-item">
        <view class="summary-number" style="color: #4CAF50;">{{testResults.summary.passedTests}}</view>
        <view class="summary-label">é€šè¿‡</view>
      </view>
      <view class="summary-item">
        <view class="summary-number" style="color: #f44336;">{{testResults.summary.failedTests}}</view>
        <view class="summary-label">å¤±è´¥</view>
      </view>
      <view class="summary-item">
        <view class="summary-number">{{testResults.summary.successRate}}%</view>
        <view class="summary-label">æˆåŠŸç‡</view>
      </view>
    </view>

    <!-- æ€»ä½“è¯„åˆ† -->
    <view class="grade-display grade-{{testResults.summary.overallGrade.toLowerCase()}}">
      <view class="grade-text">{{testResults.summary.overallGrade}}</view>
      <view class="grade-desc">
        <text wx:if="{{testResults.summary.overallGrade === 'A'}}">ä¼˜ç§€ - å®Œå…¨å…¼å®¹</text>
        <text wx:if="{{testResults.summary.overallGrade === 'B'}}">è‰¯å¥½ - åŸºæœ¬å…¼å®¹</text>
        <text wx:if="{{testResults.summary.overallGrade === 'C'}}">ä¸€èˆ¬ - éƒ¨åˆ†å…¼å®¹</text>
        <text wx:if="{{testResults.summary.overallGrade === 'D'}}">è¾ƒå·® - å…¼å®¹æ€§é—®é¢˜</text>
      </view>
    </view>

    <!-- åˆ†ç±»æµ‹è¯•ç»“æœ -->
    <view class="category-results">
      <view 
        class="category-item category-{{item.failed > 0 ? 'error' : (item.passed === item.total ? 'success' : 'warning')}}"
        wx:for="{{testResults.categoryStats}}" 
        wx:key="category">
        <view class="category-name">
          <text wx:if="{{item.category === 'basic'}}">åŸºç¡€å…¼å®¹æ€§</text>
          <text wx:if="{{item.category === 'functional'}}">åŠŸèƒ½å…¼å®¹æ€§</text>
          <text wx:if="{{item.category === 'performance'}}">æ€§èƒ½å…¼å®¹æ€§</text>
          <text wx:if="{{item.category === 'visual'}}">è§†è§‰å…¼å®¹æ€§</text>
          <text wx:if="{{item.category === 'interaction'}}">äº¤äº’å…¼å®¹æ€§</text>
        </view>
        <view class="category-stats">{{item.passed}}/{{item.total}}</view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="btn btn-primary" bindtap="viewDetailedReport">æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š</button>
      <button class="btn btn-secondary" bindtap="shareTestResults">åˆ†äº«ç»“æœ</button>
    </view>
  </view>

  <!-- æµ‹è¯•è€—æ—¶æ˜¾ç¤º -->
  <view class="test-duration" wx:if="{{testResults}}">
    <text>æµ‹è¯•è€—æ—¶: {{testResults.summary.duration}}</text>
  </view>
</view>