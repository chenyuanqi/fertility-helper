# 备小孕小程序开发指南

## 📋 项目概述

本项目是一个备小孕微信小程序，帮助用户记录基础体温、月经经量和同房情况，并提供智能的排卵预测和可视化分析。

**第一版本特点：**
- 使用微信小程序原生框架开发
- 数据存储在微信本地存储（不使用后端API）
- TypeScript 开发确保代码质量
- 组件化架构便于维护

## 🚀 开发步骤详解

### 第一阶段：环境准备与项目初始化（预计1-2天）

#### 1.1 开发环境搭建
- [x] 下载并安装[微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
- [x] 注册微信小程序账号（前往[微信公众平台](https://mp.weixin.qq.com)）
- [x] 获取小程序 AppID
- [x] 安装 Node.js（建议 16.x 或以上版本）

#### 1.2 项目初始化
- [x] 创建小程序项目结构
- [x] 配置 TypeScript 支持
- [x] 设置代码规范（ESLint + Prettier）
- [x] 创建基础配置文件

#### 1.3 项目架构设计
- [x] 设计页面结构和路由
- [x] 设计组件架构
- [x] 设计数据存储结构
- [x] 制定编码规范

### 第二阶段：基础框架搭建（预计3-4天）

#### 2.1 页面结构创建
- [x] 创建主要页面：首页、记录页、图表页、日历页、设置页
- [x] 配置页面路由和导航
- [x] 实现底部 tabBar 导航

#### 2.2 公共组件开发
- [x] 数字键盘组件（体温输入）
- [x] 滑条组件（经量选择）
- [x] 日期选择器组件
- [x] 弹窗组件
- [x] 加载组件

#### 2.3 数据管理模块
- [x] 设计本地存储数据结构
- [x] 创建数据管理工具类
- [x] 实现数据增删改查方法
- [x] 添加数据校验和容错处理

### 第三阶段：核心功能开发（预计5-7天）

#### 3.1 数据记录功能
- [x] 体温记录页面
  - [x] 数字键盘输入体温（口腔温度）
  - [x] 时间选择（默认当前时间）
  - [x] 症状备注输入
  - [x] 数据验证和保存
  - [x] 从首页快速跳转
- [x] 经量记录功能
  - [x] 经量滑条选择（0-4级：无/少量/中等/较多/大量）
  - [x] 经期开始/结束标记
  - [x] 备注输入功能
  - [x] 从首页快速跳转
- [x] 同房记录功能
  - [x] 一键时间选择
  - [x] 避孕措施选择
  - [x] 可选备注（体位、避孕情况等）
  - [x] 支持一天多次记录
  - [x] 从首页快速跳转
- [x] 记录页面统一界面
  - [x] 三种记录类型切换
  - [x] 今日记录预览
  - [x] 记录删除功能
  - [x] 响应式设计

#### 3.2 数据存储与管理
- [x] 实现微信本地存储封装
  - [x] StorageManager 通用存储类
  - [x] FertilityStorage 业务存储封装
  - [x] 存储键名统一管理
- [x] 数据同步机制（保证数据一致性）
  - [x] DataManager 单例模式
  - [x] 缓存机制实现
  - [x] 数据版本管理
- [x] 数据备份与恢复功能
  - [x] 数据导出接口设计
  - [x] 数据导入验证机制
- [x] 历史数据清理机制
  - [x] 自动清理过期数据
  - [x] 数据保留策略配置

### 第四阶段：数据可视化开发（预计4-5天）

#### 4.1 三合一图表组件
- [x] 体温折线图
  - [x] 数据点展示
  - [x] hover 交互效果
  - [x] 温度刻度显示
- [x] 经量背景区块
  - [x] 渐变色彩显示
  - [x] 经期时间范围标记
- [x] 同房图标叠加
  - [x] 不同状态图标设计
  - [x] 多次记录数字叠加

#### 4.2 辅助功能
- [x] cover-line 自动绘制
  - [x] 基于体温升高模式计算覆盖线
  - [x] 动态温度阈值显示
  - [x] 覆盖线位置自适应标注
- [x] 排卵日预测标记
  - [x] 基于cover-line位移预测排卵日
  - [x] 置信度级别显示（高/中/低）
  - [x] 可视化排卵标记和提示信息
- [x] 图表缩放和平移
  - [x] 双状态缩放切换（正常/放大）
  - [x] 智能宽度计算（基于数据量）
  - [x] 横向滚动查看和自动定位最新数据
- [x] 周期切换功能
  - [x] 上一周期/下一周期导航
  - [x] 快速回到当前周期（"今"按钮）
  - [x] 智能边界检查和用户提示

#### 4.3 日历视图
- [x] 月视图日历组件
  - [x] 完整的月份网格布局和日期渲染
  - [x] 支持跨月显示（上月末尾/下月开头）
  - [x] 今日高亮显示和选中状态
  - [x] 月份导航（上一月/下一月/回到今天）
- [x] 每日数据摘要显示
  - [x] 体温指示器（普通/高温不同颜色）
  - [x] 经期背景色（轻度/中度/重度）
  - [x] 同房标记和次数显示
  - [x] 多种数据类型同时展示
- [x] 快速跳转到具体日期
  - [x] 点击日期查看详细信息
  - [x] 无数据日期提示添加记录
  - [x] 支持跨月份导航
  - [x] 与图表视图无缝切换

### 第五阶段：智能算法集成（预计3-4天）

#### 5.1 排卵预测算法
- [ ] 基础体温分析算法
- [ ] 月经周期规律分析
- [ ] 排卵窗口计算
- [ ] 易孕期预测

#### 5.2 数据分析功能
- [ ] 周期统计分析
- [ ] 趋势分析
- [ ] 异常数据检测
- [ ] 健康建议生成

### 第六阶段：用户体验优化（预计2-3天）

#### 6.1 提醒功能
- [ ] 晨起测温提醒
- [ ] 易孕期提醒
- [ ] 排卵窗口提醒
- [ ] 自定义提醒设置

#### 6.2 导出功能
- [ ] 周期报告生成
- [ ] PDF 导出功能
- [ ] 长图分享功能
- [ ] 数据导出到相册

#### 6.3 界面优化
- [ ] 响应式布局适配
- [ ] 动画效果添加
- [ ] 加载状态优化
- [ ] 错误提示优化

### 第七阶段：测试与优化（预计2-3天）

#### 7.1 功能测试
- [ ] 单元测试编写
- [ ] 集成测试
- [ ] 用户体验测试
- [ ] 边界条件测试

#### 7.2 性能优化
- [ ] 代码分包加载
- [ ] 图片资源优化
- [ ] 数据加载优化
- [ ] 内存使用优化

#### 7.3 兼容性测试
- [ ] 不同设备适配测试
- [ ] 微信版本兼容性测试
- [ ] 操作系统兼容性测试

### 第八阶段：发布准备（预计1-2天）

#### 8.1 发布前检查
- [ ] 代码审查
- [ ] 文档完善
- [ ] 用户隐私协议
- [ ] 小程序信息完善

#### 8.2 提交审核
- [ ] 准备审核资料
- [ ] 提交微信审核
- [ ] 响应审核反馈
- [ ] 发布上线

## 🛠️ 技术选型

### 前端技术栈
- **框架**: 微信小程序原生框架
- **语言**: TypeScript
- **UI组件**: 原生组件 + 自定义组件
- **图表库**: ECharts for 小程序
- **状态管理**: 原生数据绑定 + 本地存储

### 开发工具
- **IDE**: 微信开发者工具
- **代码规范**: ESLint + Prettier
- **版本控制**: Git
- **文档**: Markdown

## 📱 项目结构

```
fertility-helper/
├── docs/                    # 项目文档
├── miniprogram/            # 小程序源码
│   ├── pages/              # 页面文件
│   │   ├── index/          # 首页
│   │   ├── record/         # 记录页
│   │   ├── chart/          # 图表页
│   │   ├── calendar/       # 日历页
│   │   └── settings/       # 设置页
│   ├── components/         # 自定义组件
│   │   ├── keyboard/       # 数字键盘
│   │   ├── slider/         # 滑条组件
│   │   ├── chart/          # 图表组件
│   │   └── calendar/       # 日历组件
│   ├── utils/              # 工具函数
│   │   ├── storage.ts      # 存储管理
│   │   ├── algorithm.ts    # 算法函数
│   │   ├── date.ts         # 日期处理
│   │   └── validator.ts    # 数据验证
│   ├── types/              # TypeScript 类型定义
│   ├── styles/             # 样式文件
│   ├── app.ts              # 应用入口
│   ├── app.json            # 应用配置
│   └── app.wxss            # 全局样式
├── project.config.json     # 项目配置
├── tsconfig.json          # TypeScript 配置
└── README.md              # 项目说明
```

## 🎯 里程碑计划

| 里程碑 | 预计完成时间 | 主要交付物 |
|--------|-------------|-----------|
| M1 | 第1-2天 | 项目环境搭建完成，基础架构确定 |
| M2 | 第3-6天 | 页面框架和基础组件开发完成 |
| M3 | 第7-13天 | 核心记录功能开发完成 |
| M4 | 第14-18天 | 数据可视化功能开发完成 |
| M5 | 第19-22天 | 智能算法集成完成 |
| M6 | 第23-25天 | 用户体验优化完成 |
| M7 | 第26-28天 | 测试和优化完成 |
| M8 | 第29-30天 | 发布准备完成，提交审核 |

## ⚠️ 重要注意事项

1. **数据隐私**: 虽然数据存储在本地，但仍需遵守微信小程序隐私政策
2. **用户体验**: 确保30秒内完成记录的设计目标
3. **数据备份**: 提供数据导出功能，防止用户数据丢失
4. **算法准确性**: 排卵预测算法需要经过充分测试
5. **兼容性**: 确保在不同设备和微信版本上正常运行

## 📚 学习资源

- [微信小程序官方文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [TypeScript 官方文档](https://www.typescriptlang.org/docs/)
- [ECharts 小程序版本](https://github.com/ecomfe/echarts-for-weixin)
- [小程序设计指南](https://developers.weixin.qq.com/miniprogram/design/)

这个开发指南将帮助您系统性地完成备小孕小程序的开发。建议按照步骤逐步推进，确保每个阶段的质量后再进入下一阶段。 