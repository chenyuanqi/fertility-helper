# å¤‡å°å­•å°ç¨‹åºæ¶æ„è®¾è®¡

## ğŸ“‹ æ•´ä½“æ¶æ„

### æ¶æ„åŸåˆ™
- **åˆ†å±‚æ¶æ„**: æ¸…æ™°çš„åˆ†å±‚ç»“æ„ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **ç»„ä»¶åŒ–**: å¯å¤ç”¨çš„ç»„ä»¶è®¾è®¡
- **æ•°æ®é©±åŠ¨**: ä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„è®¾è®¡ç†å¿µ
- **æ€§èƒ½ä¼˜å…ˆ**: è€ƒè™‘å°ç¨‹åºæ€§èƒ½ç‰¹ç‚¹çš„ä¼˜åŒ–è®¾è®¡
- **ç”¨æˆ·ä½“éªŒ**: 30ç§’å†…å®Œæˆè®°å½•çš„è®¾è®¡ç›®æ ‡

### æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: å¾®ä¿¡å°ç¨‹åºåŸç”Ÿæ¡†æ¶
- **è¯­è¨€**: TypeScript + JavaScript
- **æ ·å¼**: WXSS
- **æ•°æ®å­˜å‚¨**: å¾®ä¿¡æœ¬åœ°å­˜å‚¨
- **å›¾è¡¨**: ECharts for å°ç¨‹åº
- **æ„å»ºå·¥å…·**: å¾®ä¿¡å¼€å‘è€…å·¥å…·

## ğŸ—ï¸ ç›®å½•ç»“æ„è®¾è®¡

```
miniprogram/
â”œâ”€â”€ miniprogram/
â”‚   â”œâ”€â”€ pages/                  # é¡µé¢ç›®å½•
â”‚   â”‚   â”œâ”€â”€ index/             # é¦–é¡µ - æ•°æ®æ¦‚è§ˆ
â”‚   â”‚   â”œâ”€â”€ record/            # è®°å½•é¡µ - æ•°æ®å½•å…¥
â”‚   â”‚   â”œâ”€â”€ chart/             # å›¾è¡¨é¡µ - æ•°æ®å¯è§†åŒ–
â”‚   â”‚   â”œâ”€â”€ calendar/          # æ—¥å†é¡µ - æ—¥å†è§†å›¾
â”‚   â”‚   â””â”€â”€ settings/          # è®¾ç½®é¡µ - ç”¨æˆ·é…ç½®
â”‚   â”œâ”€â”€ components/            # è‡ªå®šä¹‰ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ keyboard/          # æ•°å­—é”®ç›˜ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ slider/            # æ»‘æ¡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ chart/             # å›¾è¡¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ calendar/          # æ—¥å†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ date-picker/       # æ—¥æœŸé€‰æ‹©å™¨
â”‚   â”‚   â””â”€â”€ modal/             # å¼¹çª—ç»„ä»¶
â”‚   â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ storage.ts         # å­˜å‚¨ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ date.ts            # æ—¥æœŸå¤„ç†
â”‚   â”‚   â”œâ”€â”€ validator.ts       # æ•°æ®éªŒè¯
â”‚   â”‚   â”œâ”€â”€ algorithm.ts       # ç®—æ³•å‡½æ•°
â”‚   â”‚   â””â”€â”€ common.ts          # é€šç”¨å·¥å…·
â”‚   â”œâ”€â”€ types/                 # ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ index.ts           # ä¸šåŠ¡ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ styles/                # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ variables.wxss     # æ ·å¼å˜é‡
â”‚   â”‚   â””â”€â”€ mixins.wxss        # æ ·å¼æ··å…¥
â”‚   â”œâ”€â”€ assets/                # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ images/            # å›¾ç‰‡èµ„æº
â”‚   â”‚   â””â”€â”€ icons/             # å›¾æ ‡èµ„æº
â”‚   â”œâ”€â”€ app.js                 # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ app.json               # åº”ç”¨é…ç½®
â”‚   â””â”€â”€ app.wxss               # å…¨å±€æ ·å¼
â”œâ”€â”€ typings/                   # ç±»å‹å£°æ˜
â”œâ”€â”€ project.config.json        # é¡¹ç›®é…ç½®
â””â”€â”€ tsconfig.json             # TypeScripté…ç½®
```

## ğŸ“± é¡µé¢æ¶æ„è®¾è®¡

### 1. é¦–é¡µ (index)
**åŠŸèƒ½**: æ•°æ®æ¦‚è§ˆå’Œå¿«é€Ÿæ“ä½œ
- ä»Šæ—¥æ•°æ®æ‘˜è¦
- å‘¨æœŸçŠ¶æ€æ˜¾ç¤º
- å¿«é€Ÿè®°å½•å…¥å£
- æ’åµé¢„æµ‹ä¿¡æ¯

**æ•°æ®æµ**:
```
Storage â†’ Page Data â†’ UI Display
```

### 2. è®°å½•é¡µ (record)
**åŠŸèƒ½**: æ•°æ®å½•å…¥ç•Œé¢
- ä½“æ¸©è®°å½•ï¼ˆæ•°å­—é”®ç›˜ï¼‰
- ç»é‡è®°å½•ï¼ˆæ»‘æ¡é€‰æ‹©ï¼‰
- åŒæˆ¿è®°å½•ï¼ˆä¸€é”®æ ‡è®°ï¼‰
- ç—‡çŠ¶è®°å½•ï¼ˆå¤šé€‰ï¼‰

**æ•°æ®æµ**:
```
User Input â†’ Validation â†’ Storage â†’ UI Feedback
```

### 3. å›¾è¡¨é¡µ (chart)
**åŠŸèƒ½**: æ•°æ®å¯è§†åŒ–
- ä¸‰åˆä¸€å›¾è¡¨ï¼ˆä½“æ¸©+ç»é‡+åŒæˆ¿ï¼‰
- å‘¨æœŸåˆ‡æ¢
- æ•°æ®ç‚¹äº¤äº’
- è¶‹åŠ¿åˆ†æ

**æ•°æ®æµ**:
```
Storage â†’ Data Processing â†’ Chart Rendering
```

### 4. æ—¥å†é¡µ (calendar)
**åŠŸèƒ½**: æ—¥å†è§†å›¾
- æœˆè§†å›¾æ—¥å†
- æ¯æ—¥æ•°æ®æ ‡è®°
- å¿«é€Ÿè·³è½¬
- æ•°æ®ç¼–è¾‘

**æ•°æ®æµ**:
```
Storage â†’ Date Range Processing â†’ Calendar Display
```

### 5. è®¾ç½®é¡µ (settings)
**åŠŸèƒ½**: ç”¨æˆ·é…ç½®
- ä¸ªäººä¿¡æ¯è®¾ç½®
- æé†’é…ç½®
- æ•°æ®å¯¼å‡º
- éšç§è®¾ç½®

**æ•°æ®æµ**:
```
User Settings â†” Storage â†” UI State
```

## ğŸ§© ç»„ä»¶æ¶æ„è®¾è®¡

### ç»„ä»¶åˆ†ç±»

#### 1. åŸºç¡€ç»„ä»¶ (Base Components)
- **Button**: ç»Ÿä¸€çš„æŒ‰é’®ç»„ä»¶
- **Input**: è¾“å…¥æ¡†ç»„ä»¶
- **Modal**: å¼¹çª—ç»„ä»¶
- **Loading**: åŠ è½½ç»„ä»¶

#### 2. ä¸šåŠ¡ç»„ä»¶ (Business Components)
- **TemperatureKeyboard**: ä½“æ¸©è¾“å…¥é”®ç›˜
- **FlowSlider**: ç»é‡é€‰æ‹©æ»‘æ¡
- **DatePicker**: æ—¥æœŸé€‰æ‹©å™¨
- **SymptomSelector**: ç—‡çŠ¶é€‰æ‹©å™¨

#### 3. å›¾è¡¨ç»„ä»¶ (Chart Components)
- **TemperatureChart**: ä½“æ¸©æŠ˜çº¿å›¾
- **CombinedChart**: ä¸‰åˆä¸€å›¾è¡¨
- **CalendarView**: æ—¥å†è§†å›¾

### ç»„ä»¶é€šä¿¡æ¨¡å¼

```
Parent Component
    â†“ props
Child Component
    â†“ events
Parent Component
    â†“ storage
Global State
```

## ğŸ’¾ æ•°æ®æ¶æ„è®¾è®¡

### æ•°æ®å­˜å‚¨ç­–ç•¥

#### 1. æœ¬åœ°å­˜å‚¨ç»“æ„
```typescript
// å­˜å‚¨é”®å
STORAGE_KEYS = {
  USER_SETTINGS: 'fertility_user_settings',
  DAY_RECORDS: 'fertility_day_records',
  CYCLES: 'fertility_cycles',
  STATISTICS: 'fertility_statistics',
}

// æ•°æ®ç»“æ„
DayRecords: {
  [date: string]: DayRecord
}

Cycles: MenstrualCycle[]

UserSettings: UserSettings

Statistics: StatisticsData
```

#### 2. æ•°æ®ç®¡ç†å±‚
```typescript
// æ•°æ®è®¿é—®å±‚
StorageManager (é€šç”¨å­˜å‚¨æ“ä½œ)
    â†“
FertilityStorage (ä¸šåŠ¡å­˜å‚¨å°è£…)
    â†“
DataService (ä¸šåŠ¡é€»è¾‘å±‚)
    â†“
Page/Component (è¡¨ç°å±‚)
```

### æ•°æ®æµè®¾è®¡

#### 1. æ•°æ®å†™å…¥æµç¨‹
```
User Input â†’ Validation â†’ Business Logic â†’ Storage â†’ UI Update
```

#### 2. æ•°æ®è¯»å–æµç¨‹
```
Page Load â†’ Storage Read â†’ Data Processing â†’ UI Render
```

#### 3. æ•°æ®åŒæ­¥æœºåˆ¶
- å®æ—¶ä¿å­˜ç”¨æˆ·è¾“å…¥
- é¡µé¢åˆ‡æ¢æ—¶åŒæ­¥æ•°æ®
- åº”ç”¨å¯åŠ¨æ—¶æ•°æ®æ ¡éªŒ

## ğŸ”„ ä¸šåŠ¡é€»è¾‘æ¶æ„

### ç®—æ³•æ¨¡å—è®¾è®¡

#### 1. æ’åµé¢„æµ‹ç®—æ³•
```typescript
class OvulationPredictor {
  // åŸºäºåŸºç¡€ä½“æ¸©çš„æ’åµæ£€æµ‹
  detectOvulationByTemperature(temperatures: TemperatureRecord[]): Date

  // åŸºäºæœˆç»å‘¨æœŸçš„æ’åµé¢„æµ‹
  predictOvulationByCycle(cycle: MenstrualCycle): Date

  // ç»¼åˆé¢„æµ‹
  predictOvulation(data: CycleData): OvulationPrediction
}
```

#### 2. å‘¨æœŸåˆ†æç®—æ³•
```typescript
class CycleAnalyzer {
  // å‘¨æœŸé•¿åº¦è®¡ç®—
  calculateCycleLength(periods: MenstrualRecord[]): number

  // é»„ä½“æœŸé•¿åº¦åˆ†æ
  analyzeLutealPhase(temperatures: TemperatureRecord[]): number

  // å‘¨æœŸè§„å¾‹æ€§åˆ†æ
  analyzeCycleRegularity(cycles: MenstrualCycle[]): number
}
```

#### 3. æ•°æ®ç»Ÿè®¡ç®—æ³•
```typescript
class StatisticsCalculator {
  // å¹³å‡ä½“æ¸©è®¡ç®—
  calculateAverageTemperature(records: TemperatureRecord[]): number

  // è¶‹åŠ¿åˆ†æ
  analyzeTrend(data: ChartDataPoint[]): TrendAnalysis

  // å¼‚å¸¸æ£€æµ‹
  detectAnomalies(records: TemperatureRecord[]): Anomaly[]
}
```

## ğŸ¨ UI/UX æ¶æ„è®¾è®¡

### è®¾è®¡ç³»ç»Ÿ

#### 1. è‰²å½©ç³»ç»Ÿ
```css
/* ä¸»è‰²è°ƒ */
--primary-color: #ff6b9d;      /* ç²‰è‰² - ä¸»è¦æ“ä½œ */
--secondary-color: #4ecdc4;    /* é’è‰² - è¾…åŠ©ä¿¡æ¯ */

/* åŠŸèƒ½è‰² */
--success-color: #52c41a;      /* æˆåŠŸçŠ¶æ€ */
--warning-color: #faad14;      /* è­¦å‘ŠçŠ¶æ€ */
--error-color: #f5222d;        /* é”™è¯¯çŠ¶æ€ */

/* ä¸­æ€§è‰² */
--text-primary: #262626;       /* ä¸»è¦æ–‡æœ¬ */
--text-secondary: #8c8c8c;     /* æ¬¡è¦æ–‡æœ¬ */
--background: #f5f5f5;         /* èƒŒæ™¯è‰² */
```

#### 2. å­—ä½“ç³»ç»Ÿ
```css
/* å­—ä½“å¤§å° */
--font-xs: 20rpx;    /* è¾…åŠ©ä¿¡æ¯ */
--font-sm: 24rpx;    /* æ¬¡è¦æ–‡æœ¬ */
--font-base: 28rpx;  /* åŸºç¡€æ–‡æœ¬ */
--font-lg: 32rpx;    /* æ ‡é¢˜æ–‡æœ¬ */
--font-xl: 36rpx;    /* å¤§æ ‡é¢˜ */
```

#### 3. é—´è·ç³»ç»Ÿ
```css
/* é—´è·è§„èŒƒ */
--space-xs: 8rpx;
--space-sm: 16rpx;
--space-md: 24rpx;
--space-lg: 32rpx;
--space-xl: 48rpx;
```

### äº¤äº’è®¾è®¡åŸåˆ™

#### 1. å¿«é€Ÿå½•å…¥
- 30ç§’å†…å®Œæˆè®°å½•
- æœ€å°‘ç‚¹å‡»æ¬¡æ•°
- æ™ºèƒ½é»˜è®¤å€¼

#### 2. ç›´è§‚åé¦ˆ
- å®æ—¶æ•°æ®éªŒè¯
- æ¸…æ™°çš„çŠ¶æ€æç¤º
- å‹å¥½çš„é”™è¯¯ä¿¡æ¯

#### 3. ä¸€è‡´æ€§
- ç»Ÿä¸€çš„äº¤äº’æ¨¡å¼
- ä¸€è‡´çš„è§†è§‰é£æ ¼
- æ ‡å‡†çš„æ“ä½œæµç¨‹

## ğŸ”§ å·¥å…·é“¾æ¶æ„

### å¼€å‘å·¥å…·é“¾
```
å¾®ä¿¡å¼€å‘è€…å·¥å…· â†’ TypeScriptç¼–è¯‘ â†’ ä»£ç æ£€æŸ¥ â†’ æ‰“åŒ…æ„å»º
```

### ä»£ç è´¨é‡ä¿è¯
```
ESLint (ä»£ç è§„èŒƒ) â†’ Prettier (ä»£ç æ ¼å¼åŒ–) â†’ TypeScript (ç±»å‹æ£€æŸ¥)
```

### æµ‹è¯•ç­–ç•¥
```
å•å…ƒæµ‹è¯• (å·¥å…·å‡½æ•°) â†’ é›†æˆæµ‹è¯• (ç»„ä»¶) â†’ ç«¯åˆ°ç«¯æµ‹è¯• (é¡µé¢æµç¨‹)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–æ¶æ„

### 1. åŠ è½½æ€§èƒ½
- åˆ†åŒ…åŠ è½½ç­–ç•¥
- å›¾ç‰‡èµ„æºä¼˜åŒ–
- ä»£ç åˆ†å‰²

### 2. è¿è¡Œæ€§èƒ½
- æ•°æ®æ‡’åŠ è½½
- è™šæ‹Ÿåˆ—è¡¨
- é˜²æŠ–èŠ‚æµ

### 3. å­˜å‚¨æ€§èƒ½
- æ•°æ®å‹ç¼©
- å¢é‡æ›´æ–°
- ç¼“å­˜ç­–ç•¥

## ğŸ”’ å®‰å…¨æ¶æ„

### 1. æ•°æ®å®‰å…¨
- æœ¬åœ°æ•°æ®åŠ å¯†
- æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
- æ•°æ®å¤‡ä»½æœºåˆ¶

### 2. éšç§ä¿æŠ¤
- æœ€å°æƒé™åŸåˆ™
- ç”¨æˆ·æˆæƒç®¡ç†
- æ•°æ®åŒ¿ååŒ–

### 3. é”™è¯¯å¤„ç†
- å…¨å±€é”™è¯¯æ•è·
- ä¼˜é›…é™çº§
- é”™è¯¯ä¸ŠæŠ¥

## ğŸš€ æ‰©å±•æ€§è®¾è®¡

### 1. åŠŸèƒ½æ‰©å±•
- æ’ä»¶åŒ–æ¶æ„
- æ¨¡å—åŒ–è®¾è®¡
- é…ç½®åŒ–å¼€å‘

### 2. æ•°æ®æ‰©å±•
- çµæ´»çš„æ•°æ®ç»“æ„
- ç‰ˆæœ¬å…¼å®¹æœºåˆ¶
- è¿ç§»ç­–ç•¥

### 3. å¹³å°æ‰©å±•
- è·¨å¹³å°é€‚é…
- APIæŠ½è±¡å±‚
- ç»Ÿä¸€æ•°æ®æ ¼å¼

è¿™ä¸ªæ¶æ„è®¾è®¡ç¡®ä¿äº†é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œä¸ºåç»­çš„å¼€å‘å·¥ä½œæä¾›äº†æ¸…æ™°çš„æŒ‡å¯¼ã€‚